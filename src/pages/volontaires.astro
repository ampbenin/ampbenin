---
import Layout from "../layouts/BaseLayout.astro";
---

<Layout title="Devenir Volontaire - AMP BENIN">
  <section class="min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-green-50 to-green-100 p-6">
    <div class="bg-white rounded-2xl shadow-lg max-w-lg w-full p-8 animate-fade-in">
      <h1 class="text-3xl font-bold text-green-700 mb-6 text-center">
        Formulaire de Volontariat
      </h1>
      <form id="volunteerForm" class="space-y-4">
        
        <div>
          <label class="block text-sm font-medium text-gray-700">Nom complet</label>
          <input type="text" name="name" required class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:ring-green-500 focus:border-green-500" />
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700">Email</label>
          <input type="email" name="email" required class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:ring-green-500 focus:border-green-500" />
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700">TÃ©lÃ©phone</label>
          <input type="text" name="phone" class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:ring-green-500 focus:border-green-500" />
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700">Domaine de volontariat</label>
          <select name="domain" class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:ring-green-500 focus:border-green-500">
            <option value="">Choisissez...</option>
            <option value="Ã‰ducation">Ã‰ducation</option>
            <option value="SantÃ©">SantÃ©</option>
            <option value="Environnement">Environnement</option>
            <option value="Autre">Autre</option>
          </select>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700">Motivation</label>
          <textarea name="motivation" rows="4" required class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:ring-green-500 focus:border-green-500"></textarea>
        </div>

        <button type="submit" class="w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-4 rounded-lg shadow-md transition-all">
          Envoyer ma candidature
        </button>

        <p id="formMessage" class="text-center mt-4 text-sm"></p>
      </form>
    </div>
  </section>

  <script>
    const form = document.getElementById('volunteerForm');
    const messageEl = document.getElementById('formMessage');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      messageEl.textContent = "Envoi en cours...";
      messageEl.className = "text-blue-600 text-center";

      const formData = Object.fromEntries(new FormData(form));

      try {
        const res = await fetch("/.netlify/functions/saveVolunteer", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(formData)
        });

        const result = await res.json();
        if (result.result === "success") {
          messageEl.textContent = "Merci pour votre inscription en tant que volontaire ðŸ™Œ";
          messageEl.className = "text-green-600 text-center";
          form.reset();
        } else {
          messageEl.textContent = "Erreur : " + (result.error || "Veuillez rÃ©essayer");
          messageEl.className = "text-red-600 text-center";
        }
      } catch (err) {
        messageEl.textContent = "Erreur de connexion au serveur";
        messageEl.className = "text-red-600 text-center";
      }
    });
  </script>
</Layout>
