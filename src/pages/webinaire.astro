---
import BaseLayout from '../layouts/BaseLayout.astro';
---

<BaseLayout title="WEBINAIRE 2 - AMP BENIN">

<!-- SECTION INTRO WEBINAIRE -->
<section class="bg-white py-16 px-6 md:px-20 text-center text-gray-900">
  <h1 class="text-4xl md:text-5xl font-extrabold leading-tight">
    WEBINAIRE II - 16 JOURS D'ACTIVISTE CONTRE LES VBG 2025
  </h1>

  <p class="mt-4 text-xl md:text-2xl font-semibold text-indigo-600">
    Th√®me : ¬´ JEUNES ET NUMERIQUE SANS VBG ¬ª
  </p>

  <p class="mt-6 max-w-3xl mx-auto text-lg md:text-xl text-gray-700 leading-relaxed">
    Participez √† notre grand webinaire interactif d√©di√© √† la protection des jeunes 
    dans les espaces num√©riques. D√©couvrez les types de violences en ligne, les 
    m√©canismes de pr√©vention, les leviers juridiques existants et le r√¥le essentiel 
    que chacun peut jouer pour b√¢tir un environnement digital plus s√ªr.
    <br /><br />
    üìÖ <strong>Samedi 06 d√©cembre 2025 √† 16H GMT+1</strong> ‚Äì √âv√®nement gratuit, ouvert √† tous.
  </p>

</section>

<!-- SECTION PANELISTES + SLIDER -->
<section class="py-16 bg-gray-50 px-4 sm:px-8 md:px-16">
  <h2 class="text-center text-3xl font-extrabold mb-10 text-gray-900">
    Nos Panelistes
  </h2>

  <!-- WRAPPER DU SLIDER -->
  <div class="relative max-w-xl sm:max-w-2xl mx-auto">

    <!-- SLIDER -->
    <div class="overflow-hidden rounded-2xl shadow-xl bg-white">
      <div 
        id="paneliste-slider" 
        class="flex transition-transform duration-700 ease-out"
      >
        <!-- Slides inject√©s par JS -->
      </div>
    </div>

    <!-- BOUTONS -->
    <button 
      id="panel-prev"
      class="absolute left-0 top-1/2 -translate-y-1/2 bg-white/90 p-3 rounded-full shadow hover:bg-white transition"
    >
      ‚óÄ
    </button>

    <button 
      id="panel-next"
      class="absolute right-0 top-1/2 -translate-y-1/2 bg-white/90 p-3 rounded-full shadow hover:bg-white transition"
    >
      ‚ñ∂
    </button>


    <!-- TEXTE PANELISTE -->
    <div id="panel-info" class="mt-6 text-center">
      <h3 id="p-nom" class="text-xl font-bold text-gray-900"></h3>
      <p id="p-titre" class="text-gray-600"></p>
      <p id="p-theme" class="mt-2 font-semibold text-indigo-600"></p>
    </div>

  </div>
</section>


<!-- SECTION COMPTE √Ä REBOURS + FORMULAIRE -->
<section class="bg-indigo-600 text-white text-center py-16 px-4">
  <h2 class="text-3xl font-extrabold">Webinaire en direct</h2>
  <p class="mt-2 text-lg opacity-90">Samedi 06 d√©cembre 2025 ‚Äî 16H GMT+1 (Heure du B√©nin)</p>

  <div id="countdown" class="text-4xl font-bold mt-6">Chargement‚Ä¶</div>

  <p class="mt-4 opacity-90">Pr√©parez-vous, l‚Äô√©v√®nement commence bient√¥t‚Ä¶</p>

  <!-- BOUTON AFFICHAGE FORMULAIRE -->
  <button
    id="toggle-form"
    class="mt-6 px-8 py-3 bg-white text-indigo-600 font-semibold rounded-lg shadow-lg hover:bg-gray-100 transition"
  >
    Me tenir inform√©
  </button>

  <!-- FORMULAIRE -->
  <form
    id="notify-form"
    class="hidden mt-8 bg-white text-gray-800 max-w-md mx-auto p-6 rounded-2xl shadow-xl space-y-5"
  >
    <h3 class="text-xl font-bold text-center text-indigo-600">
      Inscription √† la notification
    </h3>

    <input 
      type="text" 
      id="fullname" 
      placeholder="Nom complet" 
      class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none" 
      required 
    />

    <input 
      type="email" 
      id="email" 
      placeholder="Adresse email" 
      class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none" 
      required 
    />

    <!-- Le champ qui devient alert_type -->
    <input 
      type="text" 
      id="alert_type" 
      placeholder="Num√©ro WhatsApp (optionnel)" 
      class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none"
    />

    <button 
      type="submit" 
      class="w-full bg-indigo-600 text-white p-3 rounded-lg font-semibold hover:bg-indigo-700 transition"
    >
      Soumettre
    </button>

    <p id="form-message" class="text-center text-sm mt-2"></p>
  </form>
</section>


<!-- SCRIPT PANELISTES + COUNTDOWN + FORMULAIRE -->
<script client:load>

  /* -----------------------------------------
       1) LISTE PANELISTES + SLIDER
  ------------------------------------------*/
  const panelistes = [
    {
      nom: "Mme Amen MAMADOU BOUBA",
      titre: "Consultante en hygi√®ne menstruelle et en SSR",
      theme: "Comprende les diff√©rentes formes de VBG dans les environnements num√©riques",
      photo: "/images/16jours/1-Paneliste-16jours-25.webp"
    },
    {
      nom: "Mme Myrriam H√©l√®na CAKPO-CHICHI CHOUBADE ",
      titre: "Pr√©sidente de l'ONG FND, Consultante en Genre et VBG, Activiste f√©ministe",
      theme: "R√¥le et responsabilit√© des jeunes dans la cr√©ation d'un espace num√©rique s√ªr",
      photo: "/images/16jours/2-Paneliste-16jours-25.webp"
    },
    {
      nom: "Mr Thal√®s DOSSOU",
      titre: "Consultant en transformation et gouvernance num√©rique. Expert en cyberts√©curit√© et protection des donn√©es en ligne",
      theme: "Outils, lois et plateformes pour pr√©venir et lutter contre les VBG en ligne",
      photo: "/images/16jours/3-Paneliste-16jours-25.webp"
    },
  ];

  const slider = document.getElementById("paneliste-slider");

  slider.innerHTML = panelistes.map((p) => `
    <div class="min-w-full flex flex-col items-center p-6 bg-white">
      <img src="${p.photo}" 
        class="w-64 h-64 object-cover rounded-2xl shadow-md"
      />
    </div>
  `).join("");

  const pNom = document.getElementById("p-nom");
  const pTitre = document.getElementById("p-titre");
  const pTheme = document.getElementById("p-theme");

  let pIndex = 0;

  function updatePanelInfo() {
    const p = panelistes[pIndex];
    pNom.textContent = p.nom;
    pTitre.textContent = p.titre;
    pTheme.textContent = p.theme;
    slider.style.transform = `translateX(-${pIndex * 100}%)`;
  }

  document.getElementById("panel-prev").onclick = () => {
    pIndex = (pIndex - 1 + panelistes.length) % panelistes.length;
    updatePanelInfo();
  };

  document.getElementById("panel-next").onclick = () => {
    pIndex = (pIndex + 1) % panelistes.length;
    updatePanelInfo();
  };

  setInterval(() => {
    pIndex = (pIndex + 1) % panelistes.length;
    updatePanelInfo();
  }, 5000);

  updatePanelInfo();


  /* -----------------------------------------
        2) COUNTDOWN + DIRECT
  ------------------------------------------*/
  const eventTime = new Date("2025-12-06T16:00:00+01:00").getTime();
  const countdownEl = document.getElementById("countdown");

  const directBtn = document.createElement("a");
  directBtn.textContent = "Rejoindre le webinaire";
  directBtn.href = "https://meet.google.com/pzu-ugab-rvh";
  directBtn.className =
    "mt-6 inline-block bg-green-500 text-white px-6 py-3 rounded-lg font-semibold shadow hover:bg-green-600 hidden";
  countdownEl.insertAdjacentElement("afterend", directBtn);

  const msgP = countdownEl.nextElementSibling;

  setInterval(() => {
    const now = Date.now();
    const diff = eventTime - now;

    if (diff <= 0) {
      countdownEl.textContent = "Le webinaire est en cours !";
      msgP.textContent = "Cliquez sur le bouton pour rejoindre imm√©diatement.";
      directBtn.classList.remove("hidden");
      return;
    }

    if (diff <= 45 * 60 * 1000) {
      countdownEl.textContent = "Nous sommes bient√¥t en direct !";
      msgP.textContent = "Le webinaire commence dans quelques instants.";
      directBtn.classList.remove("hidden");
      return;
    }

    const j = Math.floor(diff / 86400000);
    const h = Math.floor((diff % 86400000) / 3600000);
    const m = Math.floor((diff % 3600000) / 60000);
    const s = Math.floor((diff % 60000) / 1000);

    countdownEl.textContent = `${j}j : ${h}h : ${m}m : ${s}s`;
  }, 1000);


  /* -----------------------------------------
        3) FORMULAIRE
  ------------------------------------------*/
  const form = document.getElementById("notify-form");
  const toggleBtn = document.getElementById("toggle-form");
  const msg = document.getElementById("form-message");

  toggleBtn.onclick = () => form.classList.toggle("hidden");

  form.addEventListener("submit", async (e) => {
    e.preventDefault();
    msg.textContent = "Envoi en cours‚Ä¶";

    const data = {
      fullname: document.getElementById("fullname").value.trim(),
      email: document.getElementById("email").value.trim(),
      alert_type: document.getElementById("alert_type").value.trim(), // WhatsApp
    };

    try {
      const res = await fetch("https://potential-rafa-amp1-00541efa.koyeb.app/api/newsletter", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data),
      });

      const r = await res.json();

      if (res.ok) {
        msg.textContent = "Merci ! Vous serez inform√©.";
        msg.style.color = "green";
        form.reset();
      } else {
        msg.textContent = "Erreur : " + r.message;
        msg.style.color = "red";
      }

    } catch (error) {
      msg.textContent = "Erreur r√©seau.";
      msg.style.color = "red";
    }
  });

</script>
</BaseLayout>