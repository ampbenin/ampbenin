---
const newsItems = [
  {
    image: "/images/campagne-mycountry229-paix-benin.webp",
    title: "Lancement de la Campagne Nationale Digitale #MyCountry229",
    date: "2025-08-11",
    link: "/actualites/campagne-mycountry229-paix-benin",
  },
  {
    image: "/images/news2.webp",
    title: "Atelier sur l’innovation sociale à Cotonou",
    date: "2025-09-05",
    link: "/actualites/atelier-innovation",
  },
  {
    image: "/images/news3.webp",
    title: "Forum AMP BENIN pour un Bénin durable",
    date: "2025-06-28",
    link: "/actualites/forum-benin-durable",
  },
];

// Trier par date (récentes d'abord)
const sorted = [...newsItems].sort(
  (a, b) => new Date(b.date) - new Date(a.date)
);
---
<section class="relative w-full overflow-hidden">
  <!-- Slider -->
  <div id="slider" class="flex transition-transform duration-700 ease-in-out" style={`width: calc(100% * ${sorted.length})`}>
    {sorted.map((item) => (
      <a href={item.link} class="min-w-full md:min-w-1/2 lg:min-w-1/3 flex-shrink-0 block">
        <div class="relative h-80 md:h-96 lg:h-[28rem] group overflow-hidden rounded-lg shadow-lg">
          <img 
            src={item.image} 
            alt={item.title} 
            class="w-full h-full object-cover transform transition-transform duration-700 group-hover:scale-105" 
            loading="lazy" 
          />
          <div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent text-white p-4">
            <h3 class="text-md md:text-lg font-semibold">{item.title}</h3>
            <p class="text-xs md:text-sm">{item.date}</p>
          </div>
        </div>
      </a>
    ))}
  </div>

  <!-- Boutons précédent / suivant -->
  <button id="prev" class="absolute top-1/2 left-3 -translate-y-1/2 bg-black/40 hover:bg-black/70 text-white p-3 md:p-4 rounded-full shadow-lg transition-all z-10">
    ❮
  </button>
  <button id="next" class="absolute top-1/2 right-3 -translate-y-1/2 bg-black/40 hover:bg-black/70 text-white p-3 md:p-4 rounded-full shadow-lg transition-all z-10">
    ❯
  </button>

  <!-- Pagination -->
  <div id="dots" class="absolute bottom-3 w-full flex items-center justify-center gap-3"></div>
</section>

<script type="module">
  document.addEventListener("DOMContentLoaded", () => {
    const slider = document.querySelector("#slider");
    const nextBtn = document.querySelector("#next");
    const prevBtn = document.querySelector("#prev");
    const dotsContainer = document.getElementById("dots");
    const slides = slider.children.length;
    let index = 0;

    function updateSlider() {
      slider.style.transform = `translateX(-${index * 100}%)`;
      updateDots();
    }

    function next() {
      index = (index + 1) % slides;
      updateSlider();
    }

    function prev() {
      index = (index - 1 + slides) % slides;
      updateSlider();
    }

    nextBtn.onclick = next;
    prevBtn.onclick = prev;

    // Création des points de pagination
    for (let i = 0; i < slides; i++) {
      const dot = document.createElement("div");
      dot.className = "w-3 h-3 rounded-full bg-white/50 cursor-pointer hover:bg-white transition-all";
      dot.onclick = () => {
        index = i;
        updateSlider();
      };
      dotsContainer.appendChild(dot);
    }

    function updateDots() {
      [...dotsContainer.children].forEach((dot, i) => {
        dot.className =
          "w-3 h-3 rounded-full transition-all " +
          (i === index ? "bg-white scale-125 shadow-lg" : "bg-white/50");
      });
    }

    updateDots();

    // Auto-défilement toutes les 5 secondes
    setInterval(next, 5000);
  });
</script>
