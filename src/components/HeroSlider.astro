---
const slides = [
  {
    image: "/images/impact-positif-ODD.webp",
    title: "Environnement, Climat et Promotion des ODD",
    subtitle: "Ensemble, promouvons les Objectifs de Développement Durable."
  },
  {
    image: "/images/forum-jeunesse.webp",
    title: "Engagement, Cohésion Sociale et Droits Humains",
    subtitle: "Accompagnons les jeunes et communautés vers un avenir meilleur sans inégalités sociales et violences."
  },
  {
    image: "/images/innovation.webp",
    title: "Innovation, Entrepreneuriat Social et Numérique",
    subtitle: "Soutenons les projets transformateurs dans nos communautés."
  },
  {
    image: "/images/sante-bienetre-social.webp",
    title: "Éducation, Santé et Promotion de l'Enfance",
    subtitle: "Nous intervenons dans les domaines de l'Éducation, Santé communautaire et la Promotion de l'Enfance."
  }
];
---
<section class="relative w-full overflow-hidden">
  <div id="hero-slider" class="relative h-screen">
    {slides.map((slide, i) => (
      <div
        class={`absolute inset-0 transition-opacity duration-1000 ease-in-out transform scale-100 ${i === 0 ? "opacity-100 z-10 scale-100" : "opacity-0 scale-105"}`}
        data-slide-index={i}
      >
        <img
          src={slide.image}
          alt={slide.title}
          class="w-full h-full object-cover"
          loading="lazy"
        />
        <div class="absolute inset-0 bg-gradient-to-b from-black/40 to-black/10 flex flex-col justify-center items-center text-center px-4 pt-24">
          <div class="bg-black/50 px-6 py-4 rounded-lg backdrop-blur-sm">
            <h1 class="text-3xl md:text-5xl font-extrabold mb-3 text-white drop-shadow-lg">
              {slide.title}
            </h1>
            <p class="text-base md:text-xl text-gray-200">
              {slide.subtitle}
            </p>
          </div>
        </div>
      </div>
    ))}

    <!-- Navigation dots -->
    <div class="absolute bottom-10 left-1/2 transform -translate-x-1/2 flex gap-3 z-20">
      {slides.map((_, i) => (
        <button
          class={`w-3 h-3 rounded-full bg-white/50 hover:bg-white ${i === 0 ? "bg-white" : ""}`}
          data-dot-index={i}
        ></button>
      ))}
    </div>
  </div>

  <script is:inline>
    document.addEventListener("DOMContentLoaded", () => {
      const slides = Array.from(document.querySelectorAll('#hero-slider > div[data-slide-index]'));
      const dots = document.querySelectorAll("#hero-slider button[data-dot-index]");
      let index = 0;

      function resetAnimations(slide) {
        const h1 = slide.querySelector('h1');
        const p = slide.querySelector('p');
        h1.style.animation = 'none';
        p.style.animation = 'none';
        // force reflow
        void h1.offsetWidth;
        void p.offsetWidth;
        h1.style.animation = 'fadeInUp 1s ease forwards';
        p.style.animation = 'fadeInUp 1s ease forwards 0.2s';
      }

      function showSlide(newIndex) {
        slides.forEach((slide, i) => {
          slide.classList.remove("opacity-100", "z-10", "scale-100");
          slide.classList.add("opacity-0", "scale-105");
          dots[i].classList.remove("bg-white");
          dots[i].classList.add("bg-white/50");
        });
        const activeSlide = slides[newIndex];
        activeSlide.classList.remove("opacity-0", "scale-105");
        activeSlide.classList.add("opacity-100", "z-10", "scale-100");
        resetAnimations(activeSlide);
        dots[newIndex].classList.remove("bg-white/50");
        dots[newIndex].classList.add("bg-white");
      }

      let slideInterval = setInterval(() => {
        index = (index + 1) % slides.length;
        showSlide(index);
      }, 5000);

      dots.forEach(dot => {
        dot.addEventListener("click", () => {
          clearInterval(slideInterval);
          index = parseInt(dot.dataset.dotIndex);
          showSlide(index);
          slideInterval = setInterval(() => {
            index = (index + 1) % slides.length;
            showSlide(index);
          }, 5000);
        });
      });

      // initialize first slide animations
      resetAnimations(slides[0]);
    });
  </script>

  <style>
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</section>
