import{j as o}from"./jsx-runtime.D_zvdyIk.js";import{r as i}from"./index.CRdpAhVf.js";function y({initialMissionId:x=""}){const[e,u]=i.useState({titre:"",nom:"",prenom:"",email:"",telephone:"",statut:"Non disponible"}),[d,m]=i.useState(!1),[s,l]=i.useState(null),t=r=>{u({...e,[r.target.name]:r.target.value})},f=async r=>{r.preventDefault(),m(!0),l(null);try{console.log("üì© V√©rification mission:",e.titre);const n=await fetch("https://potential-rafa-amp1-00541efa.koyeb.app/api/missions/find-by-title",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({titre:e.titre})}),p=await n.json();if(!n.ok)throw new Error(p.message||"Mission introuvable");const c=p._id?.toString();if(!c)throw new Error("Impossible de r√©cup√©rer l'ID de la mission");console.log("‚úÖ Mission trouv√©e, ObjectId:",c);const h=await fetch("https://potential-rafa-amp1-00541efa.koyeb.app/api/volunteers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({titre:e.titre,nom:e.nom,prenom:e.prenom,email:e.email,telephone:e.telephone,statut:e.statut})}),a=await h.json();if(console.log("üì¨ R√©ponse backend:",a),!h.ok)throw new Error(a.message||"Erreur lors de l'enregistrement");l({type:"success",text:a.message}),u({titre:"",nom:"",prenom:"",email:"",telephone:"",statut:"Non disponible"})}catch(n){console.error("‚ùå Erreur fetch:",n),l({type:"error",text:n.message})}finally{m(!1)}};return o.jsxs("div",{className:"max-w-md mx-auto p-6 rounded-2xl shadow-2xl bg-gradient-to-br from-yellow-50 via-white to-yellow-50 border border-yellow-200",children:[o.jsx("h2",{className:"text-2xl font-extrabold text-yellow-700 mb-4 text-center",children:"üåø Ajouter un volontaire"}),o.jsx("p",{className:"text-center text-gray-600 mb-6",children:"Remplissez le formulaire pour inscrire un nouveau volontaire pour une mission. CET ESPACE EST RESERVE UNIQUEMENT AUX ADMINISTRATEURS TECHNIQUE ET DAF DE AMP BENIN"}),o.jsxs("form",{onSubmit:f,className:"space-y-4",children:[o.jsx("input",{type:"text",name:"titre",placeholder:"Titre de la MISSION",value:e.titre,onChange:t,required:!0,className:"w-full border border-yellow-300 rounded-xl p-3 focus:ring-2 focus:ring-yellow-400 outline-none shadow-sm"}),o.jsx("input",{type:"text",name:"nom",placeholder:"Nom",value:e.nom,onChange:t,required:!0,className:"w-full border border-yellow-300 rounded-xl p-3 focus:ring-2 focus:ring-yellow-400 outline-none shadow-sm"}),o.jsx("input",{type:"text",name:"prenom",placeholder:"Pr√©nom",value:e.prenom,onChange:t,required:!0,className:"w-full border border-yellow-300 rounded-xl p-3 focus:ring-2 focus:ring-yellow-400 outline-none shadow-sm"}),o.jsx("input",{type:"email",name:"email",placeholder:"Email",value:e.email,onChange:t,required:!0,className:"w-full border border-yellow-300 rounded-xl p-3 focus:ring-2 focus:ring-yellow-400 outline-none shadow-sm"}),o.jsx("input",{type:"tel",name:"telephone",placeholder:"T√©l√©phone",value:e.telephone,onChange:t,className:"w-full border border-yellow-300 rounded-xl p-3 focus:ring-2 focus:ring-yellow-400 outline-none shadow-sm"}),o.jsxs("select",{name:"statut",value:e.statut,onChange:t,required:!0,className:"w-full border border-yellow-300 rounded-xl p-3 focus:ring-2 focus:ring-yellow-400 outline-none shadow-sm",children:[o.jsx("option",{value:"Non disponible",children:"Non disponible"}),o.jsx("option",{value:"Refus√©",children:"Refus√©"}),o.jsx("option",{value:"Mission valid√©e",children:"Mission valid√©e"})]}),o.jsx("button",{type:"submit",disabled:d,className:"w-full bg-yellow-600 text-white font-bold py-3 rounded-xl hover:bg-yellow-700 transition-all shadow-lg disabled:opacity-50",children:d?"Enregistrement...":"Enregistrer"})]}),s&&o.jsx("div",{className:`mt-4 text-center font-semibold ${s.type==="success"?"text-green-600":"text-red-600"}`,children:s.text})]})}export{y as default};
